webpackJsonp([1],{"+maj":function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("//Fk"),s=a.n(o),r=a("7+uW"),l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"Navigation"}},[a("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":e.activeIndex,router:!0,mode:"horizontal","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},on:{select:e.handleSelect}},[a("el-menu-item",{attrs:{index:"group_pre_assembly_input_system"}},[a("router-link",{attrs:{tag:"li",to:{path:"/group_pre_assembly/group_pre_assembly_input_system"}}},[e._v("预组组装录入系统")])],1),e._v(" "),a("el-menu-item",{attrs:{index:"pregroup_test"}},[a("router-link",{attrs:{tag:"li",to:{path:"/test/pregroup_test"}}},[e._v("预组装配检验")])],1),e._v(" "),a("el-menu-item",{attrs:{index:"compound_glue"}},[a("router-link",{attrs:{tag:"li",to:{path:"/glue/compound_glue"}}},[e._v("配胶")])],1),e._v(" "),a("el-menu-item",{attrs:{index:"osa_equipment_information_entry"}},[a("router-link",{attrs:{tag:"li",to:{path:"/equipment/osa_equipment_information_entry"}}},[e._v("OSA设备信息录入")])],1),e._v(" "),a("el-menu-item",{attrs:{index:"material_glue"}},[a("router-link",{attrs:{tag:"li",to:{path:"/material/material_glue"}}},[e._v("test")])],1)],1)],1)},staticRenderFns:[]};var i={name:"App",components:{navigation:a("VU/8")({name:"Navigation",data:function(){return{activeIndex:"1",logged:!1,backstage:!1,username:"",timer:""}},mounted:function(){this.proscenium=!0},methods:{handleSelect:function(e,t){this.activeIndex=e}}},l,!1,function(e){a("c4wz")},null,null).exports},provide:function(){return{reload:this.reload}},mounted:function(){},data:function(){return{frontdeskbackground:!0,isRouterAlive:!0,backstage:"true"}},watch:{$route:{handler:function(e,t){"/backstage/"===e.path.slice(0,11)?this.frontdeskbackground=!1:this.frontdeskbackground=!0},deep:!0,immediate:!0}},methods:{reload:function(){this.isRouterAlive=!1,this.$nextTick(function(){this.isRouterAlive=!0})}}},n={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[this.frontdeskbackground?t("div",[t("navigation")],1):this._e(),this._v(" "),this.isRouterAlive?t("router-view"):this._e()],1)},staticRenderFns:[]};var c=a("VU/8")(i,n,!1,function(e){a("VVhN")},"data-v-e724aabe",null).exports,m=a("/ocq"),d={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"hello"})},staticRenderFns:[]};var u=a("VU/8")({name:"HelloWorld",data:function(){return{}},mounted:function(){},methods:{}},d,!1,function(e){a("uUi1")},"data-v-d17d0a36",null).exports,f=a("mvHQ"),p=a.n(f),g=a("Gu7T"),h=a.n(g),v=a("lHA8"),_=a.n(v),b=a("fZjL"),y=a.n(b),k=a("gRE1"),w=a.n(k),x={name:"MaterialGlue",components:{},watch:{errorText:{handler:function(e,t){var a=this;!0===e&&setTimeout(function(){a.errorText=!1},6e4)}}},mounted:function(){clearInterval(this.timer),clearInterval(this.timer2),this.get_all_process()},methods:{web_socket_init:function(){if("WebSocket"in window){var e=this;e.ws=new WebSocket("ws://127.0.0.1:8003"),console.log(e.ws),e.ws.onopen=function(){console.log("open"),e.ws.send("连接脚本")},e.ws.onmessage=function(t){console.log(t),"连接脚本成功"===t.data?(e.$message({type:"success",message:"连接脚本成功!"}),e.serialText="连接脚本成功，正在连接串口...",e.tagType="success"):"自动选择正确的串口成功"===t.data?(e.serialText="连接串口成功",e.tagType="success"):"没有连接正确的串口"===t.data?(e.serialText="未连接有效串口",e.tagType="danger"):"开门成功"===t.data?(e.$message({type:"success",message:"开门成功!"}),e.serialText="已开门",e.tagType="success"):"开门失败"===t.data?(e.$message({type:"success",message:"开门失败!"}),e.serialText="开门失败",e.tagType="danger"):"关门成功"===t.data?(e.$message({type:"success",message:"关门成功!"}),e.serialText="已关门",e.tagType="success"):"关门失败"===t.data&&(e.$message({type:"success",message:"关门失败!"}),e.serialText="关门失败",e.tagType="danger")},e.ws.onerror=function(t){"error"===t.type&&!1===e.errorText&&(e.$message({type:"error",message:"未连接有效串口！"}),e.errorText=!0)},e.ws.onclose=function(t){console.log(t),e.serialText="脚本连接失败！",e.tagType="danger"},clearInterval(e.timer2),e.timer2=setInterval(function(){e.ws.send("自动选择串口")},1e4)}else this.$message({type:"error",message:"您的浏览器不支持WebSocket通信！"}),this.serialText="您的浏览器不支持WebSocket通信"},get_new:function(){this.web_socket_init()},get_open:function(){this.ws.send("开门")},get_close:function(){this.ws.send("关门")},oneSubmit:function(){this.$refs.workOrder.focus()},get_workOrder:function(){if(console.log(this.form.workOrder),""!==this.form.name)if(""===this.form.workOrder)this.$message({type:"error",message:"未输入工单号!"});else{var e=this;e.$axios({url:"/display/entry/pn-and-bom-by-worker-order",method:"get",params:{workOrder:e.form.workOrder}}).then(function(t){console.log(t);var a=t.data;null!==a&&(e.form.pn=a.Pn,e.form.bom=a.Bom,e.$refs.station.focus())}).catch(function(){this.$message({type:"error",message:"获取数据失败！"})})}else this.$message({type:"error",message:"未输入员工工号！"})},get_k3:function(){var e=this;e.$axios({url:"/display/entry/k3-material-by-work-order",method:"get",params:{workOrder:e.form.workOrder}}).then(function(t){console.log(t);var a=t.data;null!==a&&(e.k3_data=a)}).catch(function(){this.$message({type:"error",message:"获取数据失败！"})})},get_process:function(){""===this.form.station?(this.process_select=!0,this.$message({type:"error",message:"请先输入台位编号！"})):this.process_select=!1},get_all_process:function(){var e=this;e.options=[],e.$axios({url:"/display/entry/all-process",method:"get"}).then(function(t){console.log(t);var a=t.data;if(null!==a)for(var o=0;o<a.length;o++)console.log(a[o]),e.options.push({value:a[o],label:a[o]})}).catch(function(){this.$message({type:"error",message:"获取数据失败！"})})},post_process:function(){this.form.materialCode="",this.form.materialLot="",this.tcavalue=!0,this.keyMaterialValidateForm.domains=[],this.keyMaterialLogValidateForm.data=[]},put_material_code:function(){var e=this;""===e.form.materialCode&&(e.keyMaterialValidateForm.domains=[]),""!==e.form.workOrder&&""!==e.form.process?""===this.form.materialCode?(e.keyMaterial=[],e.$axios({url:"/display/entry/k3-material-of-process-by-process",method:"get",params:{process:e.form.process}}).then(function(t){console.log(t);var a=t.data;if(null!==a){var o=w()(a),s=y()(a);console.log(o),console.log(s);for(var r=function(t){1===o[t]&&"Id"!==s[t]&&(console.log(s[t]),e.keyMaterial.push(s[t]),e.$axios({url:"/display/entry/key-material-prefix-code-by-material",method:"get",params:{materialNickname:s[t]}}).then(function(a){console.log(a);var o=a.data;null!==o&&(console.log(o[0].Material),e.keyMaterialValidateForm.domains.push({key:o[0].Material,name:s[t],value:""}))}))},l=0;l<o.length;l++)r(l);e.addmaterialdialogVisible=!0}}).catch(function(){this.$message({type:"error",message:"获取数据失败！"})})):e.addmaterialdialogVisible=!0:""===e.form.workOrder?e.$message({type:"error",message:"请先完成工单匹配！"}):""!==e.form.workOrder&&""===e.form.process&&e.$message({type:"error",message:"请先选择当前工序！"})},open_k3_check:function(){console.log(this.tcavalue),!1===this.tcavalue?(this.tcavalue=!0,this.tcodialogVisible=!0,this.$message({type:"warning",message:"请先通过密码校验！"})):!0===this.tcavalue&&this.$message({type:"success",message:"已开起K3校验！"})},get_k3_password:function(){"85200"===this.k3Password?(this.tcavalue=!1,this.tcodialogVisible=!1,this.$message({type:"success",message:"校验成功，已关闭k3校验！"})):this.$message({type:"error",message:"校验失败,请输入正确的密码！"})},get_Verification:function(){if(console.log(this.tcavalue),!0===this.tcavalue){if(this.form.tco="0",""!==this.form.workOrder){for(var e=this,t=[],a=0;a<e.keyMaterialValidateForm.domains.length;a++)t=t.concat(e.keyMaterialValidateForm.domains[a].value.split(/[(\r\n)\r\n]+/));new _.a(t).size!==t.length?e.$message({type:"error",message:"存在重复的物料代码,请重新验证！"}):(e.post_glue_id(),e.errkey=[],e.$axios({url:"/display/entry/k3-material-by-work-order",method:"get",params:{workOrder:e.form.workOrder}}).then(function(t){console.log(t);var a=t.data;if(null!==a&&(e.k3_data=a,console.log(e.keyMaterialValidateForm.domains.length),e.keyMaterialValidateForm.domains.length>0))for(var o=function(t){var a=[].concat(h()(new _.a(e.keyMaterialValidateForm.domains[t].value.split(/[(\r\n)\r\n]+/))));console.log(a);for(var o=0;o<a.length;o++)""===a[o]&&(a.splice(o,1),o--);e.$axios({url:"/display/entry/key-material-prefix-code-by-material",method:"get",params:{materialNickname:e.keyMaterialValidateForm.domains[t].name}}).then(function(t){console.log(t);var o=t.data[0];if(null!==o){console.log(o.PrefixCode);for(var s=o.PrefixCode.split(","),r=0;r<a.length;r++)if(a[r].length<8)e.errkey.push(a[r]);else{for(var l=!0,i=0;i<s.length;i++)a[r].substring(0,8)===s[i]&&(l=!1);if(!0===l)e.errkey.push(a[r]);else{var n=0;console.log(e.k3_data[l]),console.log(a[r]);for(var c=0;c<e.k3_data.length;c++)e.k3_data[c]===a[r]&&(n=1);0===n&&e.errkey.push(a[r])}}if(e.errkey.length>0){console.log(e.errkey),e.materialsThatHaveNotPassedValidationVisible=!0,e.text="";for(var m=0;m<e.errkey.length;m++)e.text=0===m?e.text+e.errkey[m]:e.text+"和"+e.errkey[m]}else{e.$message({type:"success",message:"验证通过！"}),e.post_glue_id();for(var d="",u=0;u<e.keyMaterialValidateForm.domains.length;u++){var f=[].concat(h()(new _.a(e.keyMaterialValidateForm.domains[u].value.split(/[(\r\n)\r\n]+/))));console.log(f);for(var p=0;p<f.length;p++)""!==f[p]&&(d=d+e.keyMaterialValidateForm.domains[u].key+":"+f[p]+";")}e.form.materialCode=d,console.log(e.form.materialCode),console.log(e.keyMaterialValidateForm.domains),e.addmaterialdialogVisible=!1}}})},s=0;s<e.keyMaterialValidateForm.domains.length;s++)o(s)}).catch(function(){this.$message({type:"error",message:"获取数据失败！"})})),console.log(e.keyMaterialValidateForm)}}else{this.form.tco="1";for(var o="",s=[],r=0;r<this.keyMaterialValidateForm.domains.length;r++)s=s.concat(this.keyMaterialValidateForm.domains[r].value.split(/[(\r\n)\r\n]+/));if(new _.a(s).size!==s.length)this.$message({type:"error",message:"存在重复的物料代码,请重新验证！"});else{this.post_glue_id(),this.$message({type:"success",message:"验证通过！"});for(var l=0;l<this.keyMaterialValidateForm.domains.length;l++){var i=this.keyMaterialValidateForm.domains[l].value.split(/[(\r\n)\r\n]+/);console.log(i);for(var n=0;n<i.length;n++)""!==i[n]&&(o=o+this.keyMaterialValidateForm.domains[l].key+":"+i[n]+";");console.log(o)}this.form.materialCode=o,console.log(this.form.materialCode),console.log(this.keyMaterialValidateForm.domains),this.addmaterialdialogVisible=!1}}},post_glue_id:function(){this.form.materialLot="",this.keyMaterialLogValidateForm.data=[]},put_material_log:function(){if(""!==this.form.materialCode){if(0===this.keyMaterialLogValidateForm.data.length)for(var e=0;e<this.keyMaterialValidateForm.domains.length;e++){var t=this.keyMaterialValidateForm.domains[e].value.split(/[(\r\n)\r\n]+/);console.log(t);for(var a=0;a<t.length;a++)""!==t[a]&&(this.keyMaterialLogValidateForm.data.push({key:t[a],value:""}),console.log(this.keyMaterialLogValidateForm.data))}this.addMaterialLotDialogVisible=!0}else this.$message({type:"error",message:"请先添加物料代码！"})},get_add_material_log:function(){console.log(this.keyMaterialLogValidateForm);var e=JSON.parse(p()(this.keyMaterialLogValidateForm)),t=JSON.parse(p()(this.keyMaterialLogValidateForm));console.log(e);for(var a="",o=[],s=!1,r=0;r<e.data.length;r++)o=o.concat(e.data[r].value.split(/[(\r\n)\r\n]+/));if(console.log(o),new _.a(o).size!==o.length?this.$message({type:"error",message:"存在重复的物料代码,请重新验证！"}):(this.post_glue_id(),this.$message({type:"success",message:"验证通过！"}),s=!0),console.log(t),!0===s){for(var l=0;l<t.data.length;l++){var i=t.data[l].value.split(/[(\r\n)\r\n]+/);console.log(i);for(var n=0;n<i.length;n++)""!==i[n]&&(a=a+t.data[l].key+":"+i[n]+";")}this.form.materialLot=a,console.log(this.form.materialLot),this.addMaterialLotDialogVisible=!1}},get_glue_aging:function(){var e=this;""!==e.form.materialLot?""!==e.form.glueId&&(clearInterval(e.timer),e.effectivePrescription=!1,e.$axios({url:"/display/glue/glue-info-by-glue-id",method:"get",params:{glueId:e.form.glueId}}).then(function(t){console.log(t);var a=t.data;if(null!==a){console.log(a.CreatedTime),console.log(new Date(a.CreatedTime));var o=e.moment(new Date).format("YYYY-MM-DD HH:mm:ss");console.log(o),new Date-new Date(a.CreatedTime)>=48e5||1===a.RecycleFlag?(e.$message({type:"error",message:"超出时效或已回收!"}),console.log("超出时效"),console.log((new Date-new Date(a.CreatedTime))/1e3)):(console.log("未超出时效"),e.time=((new Date(a.CreatedTime)-new Date+48e5)/1e3).toFixed(0),e.effectivePrescription=!0,e.timer=setInterval(function(){new Date-new Date(a.CreatedTime)>=48e5||1===a.RecycleFlag?(console.log("超出时效"),e.effectivePrescription=!1,e.get_end_time(),clearInterval(e.timer)):(console.log("未超出时效"),e.effectivePrescription=!0,e.time=((new Date(a.CreatedTime)-new Date+48e5)/1e3).toFixed(0))},1e3))}}).catch(function(){e.$message({type:"error",message:"无此胶水ID！"})})):e.$message({type:"error",message:"未添加物料批次号，无法获取胶水时效！"})},get_start_time:function(){""!==this.form.materialLot?""===this.form.startTime?!0===this.effectivePrescription&&""!==this.form.glueId?(this.$message({type:"success",message:"开始工作！"}),this.idjudge=!0,this.addSn=!1,this.total_ount=!1,this.form.startTime=this.moment(new Date).format("YYYY-MM-DD HH:mm:ss")):!1===this.effectivePrescription&&""===this.form.glueId?(this.$message({type:"success",message:"未使用胶水,开始工作！"}),this.idjudge=!0,this.addSn=!1,this.total_ount=!1,this.form.startTime=this.moment(new Date).format("YYYY-MM-DD HH:mm:ss")):this.$message({type:"error",message:"无法开始工作！"}):this.$message({type:"error",message:"无法重复开始工作！"}):this.$message({type:"error",message:"请先录入批次号！"})},get_end_time:function(){""===this.form.endTime?""===this.form.startTime?this.$message({type:"error",message:"未开始工作，无法获得停止结束工作时间！"}):(this.$message({type:"success",message:"已结束工作！"}),this.addSn=!0,this.visible=!1,this.total_ount=!1,this.form.endTime=this.moment(new Date).format("YYYY-MM-DD HH:mm:ss")):this.$message({type:"error",message:"无法重复停止工作！"})},confirm_add:function(){if(""!==this.form.startTime){var e=this.textareaSn.split(/[(\r\n)\r\n]+/);if(new _.a(e).size!==e.length)this.$message({type:"error",message:"有重复的sn，请重新添加sn！"});else{var t="",a=0;if(console.log(e),e.length>0)for(var o=0;o<e.length;o++)""!==e[o]&&(0!==o?(t=t+";"+e[o],a+=1):(t+=e[o],a+=1));console.log(t),console.log(a),this.form.totalCount=a,this.form.sn=t,this.total_ount=!1}}else this.$message({type:"error",message:"请先开始工作,再进行添加SN！"})},post_entry:function(e){var t=this;this.$refs[e].validate(function(e){if(e)if(""!==t.form.pn||""!==t.form.bom){if(""!==t.form.startTime)if(""!==t.form.endTime)if(t.form.totalCount>=t.form.failCount){var a=t,o=new FormData,s="JS"+a.form.name;o.append("worker_id",s),o.append("work_order_num",a.form.workOrder),o.append("pn",a.form.pn),o.append("bom",a.form.bom),o.append("station_id",a.form.station),o.append("process",a.form.process),o.append("item_code",a.form.materialCode),o.append("material_num",a.form.materialLot),o.append("glue_id",a.form.glueId),o.append("start_time",a.form.startTime),o.append("end_time",a.form.endTime),o.append("sn",a.form.sn),o.append("total_count",a.form.totalCount),o.append("fail_count",a.form.failCount),o.append("tco",a.form.tco),a.$axios({url:"/display/entry/prepare-assemble-product-record",method:"post",data:o}).then(function(e){200===e.status&&a.$message({type:"success",message:"录入成功!"}),setTimeout(function(){location.reload()},2e3)}).catch(function(){a.$message({type:"error",message:"录入失败！"})})}else t.$message({type:"error",message:"不良总数大于生产总数,无法录入！"});else t.$message({type:"error",message:"未停止工作,无法录入！"});else t.$message({type:"error",message:"未开始工作,无法录入！"});console.log(t.form)}else t.$message({type:"error",message:"未进行工单匹配，无法录入！"});else t.$message({type:"error",message:"数据有误，无法录入！"})})}},beforeDestroy:function(){clearInterval(this.timer),clearInterval(this.timer2)},data:function(){return{form:{name:"",workOrder:"",pn:"",bom:"",station:"",process:"",materialCode:"",materialLot:"",glueId:"",startTime:"",endTime:"",sn:"",totalCount:"0",failCount:"0",tco:"1"},rules:{name:[{required:!0,message:"请输入工号(数字)",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"},{validator:function(e,t,a){!1===/^[0-9]{2,50}$/.test(t)?a(new Error("请输入工号(数字)")):a()},trigger:"blur"}]},keyMaterialValidateForm:{domains:[]},keyMaterialLogValidateForm:{data:[]},tagType:"info",errorText:!1,serialText:"",time:48e5,text:"",k3Password:"",textareaSn:"",k3_data:[],errkey:[],options:[],keyMaterial:[],idjudge:!1,total_ount:!1,addSn:!0,tcavalue:!0,visible:!1,process_select:!0,effectivePrescription:!1,tcodialogVisible:!1,addmaterialdialogVisible:!1,addMaterialLotDialogVisible:!1,materialsThatHaveNotPassedValidationVisible:!1}}},$={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"MaterialGlue"},[a("h3",[e._v("\n    优博创数字化工厂——预组录入系统 "),a("el-tag",{attrs:{type:e.tagType}},[e._v(e._s(e.serialText))])],1),e._v(" "),a("div",{staticStyle:{border:"1px solid black",margin:"0 auto",width:"90%"}},[a("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"150px",size:"mini"}},[a("el-form-item",{attrs:{label:"员工工号",prop:"name"}},[a("el-input",{staticStyle:{width:"100%"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.oneSubmit(t)}},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[a("template",{slot:"prepend"},[e._v("JS")])],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"工单号"}},[a("el-input",{ref:"workOrder",staticStyle:{width:"69%"},on:{blur:e.get_workOrder},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.get_workOrder(t)}},model:{value:e.form.workOrder,callback:function(t){e.$set(e.form,"workOrder",t)},expression:"form.workOrder"}}),e._v(" "),a("el-button",{staticStyle:{"background-color":"#409eff",color:"#fff",width:"30%"},on:{click:e.get_workOrder}},[e._v("工单匹配")])],1),e._v(" "),a("el-form-item",{attrs:{label:"产品PN"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{disabled:!0},model:{value:e.form.pn,callback:function(t){e.$set(e.form,"pn",t)},expression:"form.pn"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"BOM"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{disabled:!0},model:{value:e.form.bom,callback:function(t){e.$set(e.form,"bom",t)},expression:"form.bom"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"台位编号"}},[a("el-input",{ref:"station",staticStyle:{width:"100%"},model:{value:e.form.station,callback:function(t){e.$set(e.form,"station",t)},expression:"form.station"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"当前工序"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择当前工序"},on:{change:e.post_process,focus:e.get_process},model:{value:e.form.process,callback:function(t){e.$set(e.form,"process",t)},expression:"form.process"}},e._l(e.options,function(t){return a("el-option",{key:t.value,attrs:{disabled:e.process_select,label:t.label,value:t.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"物料代码"}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.form.materialCode))]),e._v(" "),a("el-input",{staticStyle:{width:"69%"},attrs:{disabled:!0},on:{change:e.post_glue_id},model:{value:e.form.materialCode,callback:function(t){e.$set(e.form,"materialCode",t)},expression:"form.materialCode"}})],1),e._v(" "),a("el-button",{staticStyle:{"background-color":"#409eff",color:"#fff",width:"30%"},on:{click:e.put_material_code}},[e._v("添加物料代码")])],1),e._v(" "),a("el-form-item",{attrs:{label:"物料批次号"}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.form.materialLot))]),e._v(" "),a("el-input",{staticStyle:{width:"69%"},attrs:{disabled:!0},model:{value:e.form.materialLot,callback:function(t){e.$set(e.form,"materialLot",t)},expression:"form.materialLot"}})],1),e._v(" "),a("el-button",{staticStyle:{"background-color":"#409eff",color:"#fff",width:"30%"},on:{click:e.put_material_log}},[e._v("添加物料批次")])],1),e._v(" "),a("el-form-item",{attrs:{label:"胶水ID"}},[a("el-input",{staticStyle:{width:"69%"},attrs:{disabled:e.idjudge},on:{change:e.get_glue_aging},model:{value:e.form.glueId,callback:function(t){e.$set(e.form,"glueId",t)},expression:"form.glueId"}}),e._v(" "),e.effectivePrescription?a("el-button",{staticStyle:{"background-color":"#67C23A",color:"#fff",width:"30%"}},[e._v("时效："+e._s(e.time)+" 秒")]):a("el-button",{staticStyle:{"background-color":"red",color:"#fff",width:"30%"}},[e._v("时效：0 秒")])],1),e._v(" "),a("el-form-item",{attrs:{label:"工作开始时间"}},[a("el-input",{staticStyle:{width:"69%"},attrs:{disabled:!0},model:{value:e.form.startTime,callback:function(t){e.$set(e.form,"startTime",t)},expression:"form.startTime"}}),e._v(" "),a("el-button",{staticStyle:{"background-color":"#409eff",color:"#fff",width:"30%"},on:{click:e.get_start_time}},[e._v("开始")])],1),e._v(" "),a("el-form-item",{attrs:{label:"SN"}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.form.sn))]),e._v(" "),a("el-input",{staticStyle:{width:"69%"},attrs:{disabled:!0},model:{value:e.form.sn,callback:function(t){e.$set(e.form,"sn",t)},expression:"form.sn"}})],1),e._v(" "),a("el-popover",{attrs:{placement:"right",width:"300",title:"SN",trigger:"manual"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:1,maxRows:4}},model:{value:e.textareaSn,callback:function(t){e.textareaSn=t},expression:"textareaSn"}}),e._v(" "),a("el-button",{staticStyle:{"background-color":"#409eff",color:"#fff",width:"30%"},on:{click:e.confirm_add}},[e._v("确认添加")]),e._v(" "),a("el-button",{staticStyle:{"background-color":"#409eff",color:"#fff",width:"30%"},attrs:{slot:"reference",disabled:e.addSn},on:{click:function(t){e.visible=!e.visible}},slot:"reference"},[e._v("添加SN")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"生产总数"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{disabled:e.total_ount},model:{value:e.form.totalCount,callback:function(t){e.$set(e.form,"totalCount",t)},expression:"form.totalCount"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"不良总数"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{min:0,max:e.form.totalCount},model:{value:e.form.failCount,callback:function(t){e.$set(e.form,"failCount",e._n(t))},expression:"form.failCount"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"工作结束时间"}},[a("el-input",{staticStyle:{width:"69%"},attrs:{disabled:!0},model:{value:e.form.endTime,callback:function(t){e.$set(e.form,"endTime",t)},expression:"form.endTime"}}),e._v(" "),a("el-button",{staticStyle:{"background-color":"#409eff",color:"#fff",width:"30%"},on:{click:e.get_end_time}},[e._v("停止")])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.post_entry("form")}}},[e._v("录入")])],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"添加关键物料",visible:e.addmaterialdialogVisible,width:"80%"},on:{"update:visible":function(t){e.addmaterialdialogVisible=t}}},[a("el-dialog",{attrs:{title:"tco验证",visible:e.tcodialogVisible,width:"80%","append-to-body":""},on:{"update:visible":function(t){e.tcodialogVisible=t}}},[a("el-form",{attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"请输入密码："}},[a("el-input",{staticStyle:{width:"68%"},attrs:{"show-password":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.get_k3_password(t)}},model:{value:e.k3Password,callback:function(t){e.k3Password=t},expression:"k3Password"}}),e._v(" "),a("el-button",{staticStyle:{width:"30%"},on:{click:e.get_k3_password}},[e._v("确认")])],1)],1)],1),e._v(" "),a("el-form",{staticClass:"demo-dynamic",attrs:{model:e.keyMaterialValidateForm,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"是否开启K3检验(TCO)"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"开","inactive-text":"关"},on:{change:e.open_k3_check},model:{value:e.tcavalue,callback:function(t){e.tcavalue=t},expression:"tcavalue"}})],1),e._v(" "),e._l(e.keyMaterialValidateForm.domains,function(t,o){return a("el-form-item",{key:t.key,attrs:{label:e.keyMaterialValidateForm.domains[o].key,prop:"domains."+o+".value",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"domain.value"}})],1)})],2),e._v(" "),a("el-button",{on:{click:e.get_Verification}},[e._v("验证")]),e._v(" "),a("el-dialog",{attrs:{width:"30%",title:"未验证通过的物料",visible:e.materialsThatHaveNotPassedValidationVisible,"append-to-body":""},on:{"update:visible":function(t){e.materialsThatHaveNotPassedValidationVisible=t}}},[a("p",[e._v(e._s(e.text))])])],1),e._v(" "),a("el-dialog",{attrs:{title:"添加物料批次",visible:e.addMaterialLotDialogVisible,width:"80%"},on:{"update:visible":function(t){e.addMaterialLotDialogVisible=t}}},[a("el-form",{staticClass:"demo-dynamic",attrs:{model:e.keyMaterialLogValidateForm,"label-width":"130px"}},e._l(e.keyMaterialLogValidateForm.data,function(t,o){return a("el-form-item",{key:t.key,attrs:{label:e.keyMaterialLogValidateForm.data[o].key,prop:"data."+o+".value",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"data.value"}})],1)}),1),e._v(" "),a("el-button",{on:{click:e.get_add_material_log}},[e._v("确认添加")])],1)],1)},staticRenderFns:[]};var S=a("VU/8")(x,$,!1,function(e){a("+maj")},"data-v-26c23068",null).exports,V={name:"CompoundGlue",components:{},data:function(){return{currentPage:1,pageSize:100,time:"",text:"",glueId:"",addGlueId:"",gluedata:[],errlist:[],postdata:[],glueVisible:!1,dialogVisible:!1,periodTimeVisible:!1,pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),a.setHours(0),a.setMinutes(0),a.setSeconds(0),t.setTime(a.getTime()+6048e5),t.setHours(0),t.setMinutes(0),t.setSeconds(0),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),a.setHours(0),a.setMinutes(0),a.setSeconds(0),t.setTime(a.getTime()+2592e6),t.setHours(0),t.setMinutes(0),t.setSeconds(0),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),a.setHours(0),a.setMinutes(0),a.setSeconds(0),t.setTime(a.getTime()+7776e6),t.setHours(0),t.setMinutes(0),t.setSeconds(0),e.$emit("pick",[a,t])}}]},value1:[],value2:[],startTime:"",endTime:"",periodTimeData:[]}},mounted:function(){this.time=this.moment(new Date).format("YYYY-MM-DD HH:mm:ss"),this.get_time(),this.get_timer()},methods:{handleSizeChange:function(e){this.pageSize=e},handleCurrentChange:function(e){this.currentPage=e},get_timer:function(){var e=new Date,t=new Date;t.setTime(t.getTime()),t.setHours(8),t.setMinutes(0),t.setSeconds(0),e.setTime(t.getTime()+864e5),e.setHours(8),e.setMinutes(0),e.setSeconds(0),this.value2=[t,e],console.log(this.value2)},del_local_data:function(){localStorage.removeItem("RemovedData")},get_period_of_time:function(){var e=this;this.periodTimeVisible=!0,this.startTime=this.moment(this.value2[0]).format("YYYY-MM-DD HH:mm:ss"),this.endTime=this.moment(this.value2[1]).format("YYYY-MM-DD HH:mm:ss"),console.log(this.startTime),console.log(this.endTime),this.del_local_data(),clearInterval(this.datatimer),this.get_period_time_data(),this.datatimer=setInterval(function(){e.get_period_time_data()},2e4)},get_period_time_data:function(){var e=this;e.$axios({url:"/display/glue/glue-info-by-time-field",method:"get",params:{startTime:e.startTime,endTime:e.endTime}}).then(function(t){console.log(t);var a=t.data;if(null!==a&&0!==a.length){for(var o=0;o<a.length;o++){var s=new Date(a[o].CreatedTime).setSeconds(new Date(a[o].CreatedTime).getSeconds()+4800);a[o].FailureTime=e.moment(s).format("YYYY-MM-DD HH:mm:ss"),0===a[o].RecycleFlag?a[o].RecycleFlag="未回收":a[o].RecycleFlag="已回收"}var r=localStorage.getItem("RemovedData");if(console.log(r),null!==r){var l=r.split(",");console.log(l);for(var i=0;i<l.length;i++)for(var n=0;n<a.length;n++)l[i]===String(a[n].Id)&&(a.splice(n,1),n-=1)}e.periodTimeData=a,console.log(a)}})},tableRowClassName:function(e){var t=e.row;e.rowIndex;return new Date(t.FailureTime)<=new Date?"未回收"===t.RecycleFlag?"error-row":"warning-row":"未回收"===t.RecycleFlag?"success-row":void 0},deleteRow:function(e,t){console.log(this.$refs.multipleTable.tableData),console.log(this.currentPage),console.log(e),console.log(t),"已回收"===this.$refs.multipleTable.tableData[e].RecycleFlag?this.$message({type:"error",message:"已回收，无法再次回收！"}):this.get_delect_data(this.$refs.multipleTable.tableData[e].GlueId)},get_delect_data:function(e){var t=this;console.log(e);var a=new FormData;a.append("glue_id",e),a.append("recycle_time",t.moment(new Date).format("YYYY-MM-DD HH:mm:ss")),t.$axios({method:"put",url:"/display/glue/recycle-flag-glue-info",data:a}).then(function(e){console.log(e),t.get_period_time_data()})},get_time:function(){var e=this;this.timer=setInterval(function(){e.time=e.moment(new Date).format("YYYY-MM-DD HH:mm:ss")},1e3)},get_glue:function(){console.log(this.glueId);var e=this;e.gluedata=[],e.$axios({url:"/display/glue/glue-info-by-glue-id",method:"get",params:{glueId:e.glueId}}).then(function(t){console.log(t);var a=t.data;null!==a&&(e.glueVisible=!0,e.gluedata.push(a))}).catch(function(t){e.glueVisible=!1,401===t.response.status?(alert("用户未登录或登录已过期"),localStorage.clear(),e.$router.push({path:"/user/login/"}),window.location.reload()):403===t.response.status?e.$message({type:"error",message:"权限不够！"}):404===t.response.status?e.$message({type:"error",message:"未找到数据！"}):504===t.response.status?e.$message({type:"error",message:"服务器未响应！"}):e.$message({type:"error",message:"创建失败！"})})},post_glue:function(){var e=this;console.log(this.addGlueId),this.postdata=[].concat(h()(new _.a(this.addGlueId.split(/[(\r\n)\r\n]+/)))),console.log(this.addGlueId),console.log(this.postdata),this.errlist=[],console.log(this.postdata[1]);for(var t=function(t){if(console.log(e.postdata[1]),""!==e.postdata[t]){var a=e;console.log(a.postdata[t]);var o=new FormData;o.append("glue_id",a.postdata[t]),o.append("created_time",a.moment(new Date).format("YYYY-MM-DD HH:mm:ss")),a.$axios({url:"/display/glue/glue-info",method:"post",data:o}).then(function(e){console.log(e)}).catch(function(){a.$message({type:"error",message:"创建失败的胶水："+a.postdata[t]})})}},a=0;a<this.postdata.length;a++)t(a)}},beforeDestroy:function(){clearInterval(this.timer),clearInterval(this.datatimer)}},D={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"CompoundGlue"},[a("div",{staticStyle:{margin:"0 auto",border:"1px solid black",width:"85%"}},[a("h2",[e._v("创建胶水")]),e._v(" "),a("h4",[e._v("当前时间："+e._s(e.time))]),e._v(" "),a("el-input",{staticStyle:{width:"35%"},attrs:{placeholder:"请输入胶水ID",type:"textarea",autosize:{minRows:1,maxRows:5}},model:{value:e.addGlueId,callback:function(t){e.addGlueId=t},expression:"addGlueId"}}),e._v(" "),a("el-button",{staticStyle:{"background-color":"#409eff",color:"#fff",width:"80px"},on:{click:e.post_glue}},[e._v("创建")])],1),e._v(" "),a("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("h2",[e._v("创建失败的胶水有：")]),e._v(" "),a("h3",[e._v(e._s(e.text))])]),e._v(" "),a("br"),e._v(" "),a("div",{staticStyle:{margin:"0 auto",border:"1px solid black",width:"85%"}},[a("h2",[e._v("查询单个胶水信息")]),e._v(" "),a("el-input",{staticStyle:{width:"35%"},attrs:{placeholder:"请输入胶水ID"},model:{value:e.glueId,callback:function(t){e.glueId=t},expression:"glueId"}}),e._v(" "),a("el-button",{staticStyle:{"background-color":"#409eff",color:"#fff",width:"80px"},attrs:{icon:"el-icon-search"},on:{click:e.get_glue}}),e._v(" "),e.glueVisible?a("div",{staticStyle:{margin:"0 auto"}},[a("br"),e._v(" "),a("el-table",{staticStyle:{width:"80%",margin:"0 auto",border:"1px solid black"},attrs:{data:e.gluedata}},[a("el-table-column",{attrs:{prop:"Id",label:"Id"}}),e._v(" "),a("el-table-column",{attrs:{prop:"GlueId",label:"GlueId"}}),e._v(" "),a("el-table-column",{attrs:{prop:"CreatedTime",label:"CreatedTime"}})],1)],1):e._e()],1),e._v(" "),a("br"),e._v(" "),a("div",{staticStyle:{margin:"0 auto",border:"1px solid black",width:"85%"}},[a("h2",[e._v("查询时间段内的所有胶水信息")]),e._v(" "),a("el-date-picker",{attrs:{type:"datetimerange","picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}}),e._v(" "),a("el-button",{staticStyle:{"background-color":"#409eff",color:"#fff",height:"40px",width:"80px"},attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.get_period_of_time},slot:"append"}),e._v(" "),e.periodTimeVisible?a("div",{staticStyle:{margin:"0 auto"}},[a("br"),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"90%",margin:"0 auto",border:"1px solid black"},attrs:{data:e.periodTimeData.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize),"row-class-name":e.tableRowClassName,border:"","row-style":{height:"10px"},"cell-style":{padding:0}}},[a("el-table-column",{attrs:{prop:"Id",label:"Id"}}),e._v(" "),a("el-table-column",{attrs:{prop:"GlueId",label:"胶水ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:"CreatedTime",label:"创建时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"FailureTime",label:"失效时间",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"RecycleFlag",label:"状态"}}),e._v(" "),a("el-table-column",{attrs:{prop:"RecycleTime",label:"回收时间",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"40"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"el-icon-s-order",staticStyle:{color:"black","background-color":"white"},on:{click:function(a){return e.deleteRow(t.$index,e.periodTimeData)}}})]}}],null,!1,4155239306)})],1),e._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{align:"center","current-page":e.currentPage,"page-sizes":[100,200,500,1e3],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.periodTimeData.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1):e._e()],1)],1)},staticRenderFns:[]};var j=a("VU/8")(V,D,!1,function(e){a("dbEy")},null,null).exports,C=a("c/Tr"),M=a.n(C),T={name:"PregroupTest",components:{},data:function(){return{workID:"",resultAssemble:"",needAssemble:[],hasAssemble:[],NoAssemble:[],dialogVisible:!1}},mounted:function(){},watch:{dialogVisible:{handler:function(e,t){!1===e&&this.$refs.mark.focus()}}},methods:{getInputFocus:function(e){e.currentTarget.select()},get_workOrder:function(){""!==this.workID?(this.resultAssemble="",this.needAssemble=[],this.hasAssemble=[],this.NoAssemble=[],this.get_k3_work()):this.$message({type:"error",message:"未输入工单号！"})},get_k3_work:function(){var e=this;e.$axios({method:"get",url:"/display/entry/k3-material-by-work-order",params:{workOrder:e.workID}}).then(function(t){console.log(t);var a=t.data;if(0!==a.length){for(var o=[],s=0;s<a.length;s++)o.push(a[s]);e.get_has_work(),e.needAssemble=o}else e.$message({type:"error",message:"此工单暂无数据！"})}).catch(function(t){401===t.response.status?(alert("用户未登录或登录已过期"),localStorage.clear(),e.$router.push({path:"/user/login/"}),window.location.reload()):403===t.response.status?e.$message({type:"error",message:"权限不够！"}):404===t.response.status?e.$message({type:"error",message:"未找到数据！"}):504===t.response.status?e.$message({type:"error",message:"服务器未响应！"}):e.$message({type:"error",message:"查询失败！"})})},get_has_work:function(){var e=this;e.$axios({method:"get",url:"/display/check/all-material-of-prepare-assemble-product-record-by-worker-order",params:{workOrderNum:e.workID}}).then(function(t){console.log(t);var a=t.data;if(0!==a.length)if(1===a.length&&"tco"===a[0])e.dialogVisible=!0,e.resultAssemble="当前为TCO工单";else{for(var o=M()(new _.a(a)),s=[],r=0;r<o.length;r++)s.push(o[r]);e.hasAssemble=s,console.log(e.hasAssemble.length),console.log(e.needAssemble.length),e.hasAssemble.length!==e.needAssemble.length?e.work_Test():(e.dialogVisible=!0,e.resultAssemble="通过")}else e.dialogVisible=!0,e.resultAssemble="未装配"}).catch(function(t){401===t.response.status?(alert("用户未登录或登录已过期"),localStorage.clear(),e.$router.push({path:"/user/login/"}),window.location.reload()):403===t.response.status?e.$message({type:"error",message:"权限不够！"}):404===t.response.status?e.$message({type:"error",message:"未找到数据！"}):504===t.response.status?e.$message({type:"error",message:"服务器未响应！"}):e.$message({type:"error",message:"查询失败！"})})},work_Test:function(){if(0!==this.hasAssemble.length&&0!==this.needAssemble.length){for(var e=JSON.parse(p()(this.needAssemble)),t=0;t<this.hasAssemble.length;t++)for(var a=0;a<e.length;a++)e[a]===this.hasAssemble[t]&&(e.splice(a,1),a--);console.log(e),0!==e.length&&(this.NoAssemble=e,this.dialogVisible=!0,this.resultAssemble="未通过")}}}},F={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"PregroupTest"},[a("div",{staticStyle:{border:"1px solid black",width:"100%"}},[a("div",{staticStyle:{margin:"0 auto",width:"100%"}},[a("h2",[e._v("查询装配结果")]),e._v(" "),a("el-input",{ref:"mark",staticStyle:{width:"30%"},attrs:{clearable:"",placeholder:"请输入工单号"},on:{focus:function(t){return e.getInputFocus(t)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.get_workOrder(t)}},model:{value:e.workID,callback:function(t){e.workID=t},expression:"workID"}}),e._v(" "),a("el-button",{staticStyle:{"background-color":"#409eff",color:"#fff",width:"80px"},attrs:{icon:"el-icon-search"},on:{click:e.get_workOrder}})],1),e._v(" "),a("br"),e._v(" "),a("div",{staticStyle:{"text-align":"justify"}},[a("el-row",[a("el-col",{attrs:{span:3,offset:1}},[a("b",[e._v("需装配：")])]),e._v(" "),a("el-col",{attrs:{span:20}},e._l(e.needAssemble,function(t,o){return a("span",{key:o},[a("el-tag",{staticStyle:{"margin-right":"5px"}},[e._v(e._s(t))])],1)}),0)],1),e._v(" "),a("br"),e._v(" "),a("el-row",[a("el-col",{attrs:{span:3,offset:1}},[a("b",[e._v("已装配：")])]),e._v(" "),a("el-col",{attrs:{span:20}},e._l(e.hasAssemble,function(t,o){return a("span",{key:o},[a("el-tag",{staticStyle:{"margin-right":"5px"},attrs:{type:"success"}},[e._v(e._s(t))])],1)}),0)],1),e._v(" "),a("br"),e._v(" "),a("el-row",[a("el-col",{attrs:{span:3,offset:1}},[a("b",[e._v("未装配：")])]),e._v(" "),a("el-col",{attrs:{span:20}},e._l(e.NoAssemble,function(t,o){return a("span",{key:o},[a("el-tag",{staticStyle:{"margin-right":"5px"},attrs:{type:"danger"}},[e._v(e._s(t))])],1)}),0)],1),e._v(" "),a("br"),e._v(" "),a("el-row",[a("el-col",{attrs:{span:3,offset:1}},[a("b",[e._v("装配结果：")])]),e._v(" "),a("el-col",{attrs:{span:20}},[a("b",[e._v(e._s(e.resultAssemble))])])],1)],1)]),e._v(" "),a("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible,top:"20%",width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("h2",[a("i",{staticClass:"el-icon-warning-outline",staticStyle:{width:"50px",color:"red"}}),e._v(e._s(e.resultAssemble))])])],1)},staticRenderFns:[]};var I=a("VU/8")(T,F,!1,function(e){a("Zaqt")},"data-v-53bfcf58",null).exports,O={name:"OSAEquipmentInformationEntry",components:{},mounted:function(){this.get_import_equipment()},methods:{ID_Enter:function(){""!==this.stationID&&this.$refs.job.focus()},job_Enter:function(){""!==this.jobID&&this.$refs.pn.focus()},pn_Enter:function(){""!==this.pn&&this.$refs.process.focus()},get_import_equipment:function(){var e=this;e.options=[],e.$axios({url:"/display/osa-device-entry/osa-device-set",method:"get"}).then(function(t){console.log(t);var a=t.data;if(null!==a){console.log(a),e.importEquipment=a;var o=M()(y()(a));console.log(o);for(var s=0;s<o.length;s++)e.options.push({value:o[s],label:o[s]})}}).catch(function(e){console.log(e)})},get_code:function(){var e=this;""!==e.quickResponseCode&&(e.verificationResult="",e.$axios({url:"/api/device-base/detail",method:"get",params:{assets:e.quickResponseCode}}).then(function(t){console.log(t);var a=t.data;null!==a&&(console.log(a),"正常"!==a.status_of_maintenance&&"未绑定"!==a.status_of_maintenance||"正常"!==a.status_of_repair&&"未绑定"!==a.status_of_repair?(e.fontcolor="color: red","正常"!==a.status_of_maintenance&&"未绑定"!==a.status_of_maintenance&&(e.verificationResult="维修状态："+a.status_of_maintenance+";"),"正常"!==a.status_of_repair&&"未绑定"!==a.status_of_repair&&(e.verificationResult="保养状态："+a.status_of_repair+";")):(e.fontcolor="color: green",console.log("通过"),e.verificationResult="通过",e.quickResponseCode=null,e.tableData.push({name:a.device_base_info.category_child,assets:a.device_base_info.assets,maintenance:a.status_of_maintenance,repair:a.status_of_repair,state:"已通过"}),console.log(e.tableData)))}).catch(function(t){console.log(t),e.$message({type:"error",message:"获取设备校验信息失败！"})}))},process_change:function(){this.tableData=[],console.log(this.process),console.log(this.importEquipment[this.process])},deleteRow:function(e,t){t.splice(e,1)},entry_button:function(){if(console.log(this.tableData),0!==this.tableData.length){for(var e=JSON.parse(p()(this.importEquipment[this.process])),t=0;t<this.tableData.length;t++)for(var a=0;a<e.length;a++)e[a]===this.tableData[t].name&&(e.splice(a,1),a--);console.log(e),0===e.length?(console.log("可以录入"),this.get_entry()):this.$message({type:"error",message:"重要设备信息未录入！"})}},get_entry:function(){if(""!==this.stationID&&""!==this.jobID&&""!==this.pn&&""!==this.process){for(var e=[],t=0;t<this.tableData.length;t++)e.push(this.tableData[t].assets);if((e=M()(new _.a(e))).length===this.tableData.length){for(var a=this,o=",",s=0;s<a.tableData.length;s++)o=0===s?a.tableData[s].assets:o+","+a.tableData[s].assets;var r=a.moment(new Date).format("YYYY-MM-DD HH:mm:ss"),l=new FormData;l.append("station_id",a.stationID),l.append("operator_id",a.jobID),l.append("entry_time",r),l.append("process",a.process),l.append("pn",a.pn),l.append("device_sn_list",o),a.$axios({url:"/display/osa-device-entry/osa-device-entry-info",method:"post",data:l}).then(function(e){a.$message({type:"success",message:"录入成功！"}),a.tableData=[]}).catch(function(e){console.log(e),a.$message({type:"error",message:"录入失败!"})})}else this.$message({type:"error",message:"有重复的设备信息！"})}else this.$message({type:"error",message:"请输入基本信息！"})}},data:function(){return{fontcolor:"",verificationResult:"",stationID:"",jobID:"",pn:"",quickResponseCode:"",tableData:[],process:"",options:[],importEquipment:[]}}},N={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"OSAEquipmentInformationEntry"},[a("h3",[e._v("优博创数字化工厂——OSA设备信息录入")]),e._v(" "),a("div",{staticStyle:{border:"1px solid black",height:"550px"}},[a("el-row",[a("el-col",{attrs:{span:10}},[a("br"),e._v(" "),a("el-form",{staticStyle:{"border-bottom":"1px solid black",height:"300px"},attrs:{"label-width":"80px",size:"mini"}},[a("el-form-item",{attrs:{label:"台位编号"}},[a("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.ID_Enter(t)}},model:{value:e.stationID,callback:function(t){e.stationID=t},expression:"stationID"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"工号"}},[a("el-input",{ref:"job",nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.job_Enter(t)}},model:{value:e.jobID,callback:function(t){e.jobID=t},expression:"jobID"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"PN"}},[a("el-input",{ref:"pn",nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.pn_Enter(t)}},model:{value:e.pn,callback:function(t){e.pn=t},expression:"pn"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"工序"}},[a("el-select",{ref:"process",attrs:{placeholder:"请选择"},on:{change:e.process_change},model:{value:e.process,callback:function(t){e.process=t},expression:"process"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"设备固资号"}},[a("el-input",{attrs:{clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.get_code(t)}},model:{value:e.quickResponseCode,callback:function(t){e.quickResponseCode=t},expression:"quickResponseCode"}})],1),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.get_code}},[e._v("设备校验")])],1),e._v(" "),a("div",{staticStyle:{height:"200px"}},[a("h4",[e._v("校验结果:")]),e._v(" "),a("b",{style:e.fontcolor},[e._v(e._s(e.verificationResult))])])],1),e._v(" "),a("el-col",{attrs:{span:14}},[a("el-table",{staticStyle:{width:"100%","border-left":"1px solid black"},attrs:{data:e.tableData,height:"550",border:""}},[a("el-table-column",{attrs:{prop:"name",label:"设备类型"}}),e._v(" "),a("el-table-column",{attrs:{prop:"assets",label:"固资号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"maintenance",label:"维修状态"}}),e._v(" "),a("el-table-column",{attrs:{prop:"repair",label:"保养状态"}}),e._v(" "),a("el-table-column",{attrs:{prop:"state",label:"状态"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"el-icon-delete",attrs:{type:"danger",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.deleteRow(t.$index,e.tableData)}}})]}}])})],1)],1)],1)],1),e._v(" "),a("br"),e._v(" "),a("el-button",{staticStyle:{width:"150px"},attrs:{type:"info"}},[e._v("重置")]),e._v(" "),a("el-button",{staticStyle:{width:"150px"},attrs:{type:"primary"},on:{click:e.entry_button}},[e._v("录入")])],1)},staticRenderFns:[]};var R=a("VU/8")(O,N,!1,function(e){a("iYGR")},"data-v-5eebd3dc",null).exports,L={name:"WebSerialApi",components:{},data:function(){return{ws:""}},mounted:function(){this.webSocket()},methods:{webSocket:function(){if("WebSocket"in window){var e=this;e.ws=new WebSocket("ws://127.0.0.1:8003"),console.log(e.ws),e.ws.onopen=function(){console.log("open"),e.ws.send("连接脚本")},e.ws.onmessage=function(t){console.log(t),"连接脚本成功"===t.data?e.$message({type:"success",message:"连接脚本成功!"}):"自动选择正确的串口成功"===t.data?e.$message({type:"success",message:"自动选择正确的串口成功!"}):"没有连接正确的串口"===t.data?e.$message({type:"error",message:"自动选择正确的串口失败!"}):"开门成功"===t.data?e.$message({type:"success",message:"开门成功!"}):"开门失败"===t.data?e.$message({type:"success",message:"开门失败!"}):"关门成功"===t.data?e.$message({type:"success",message:"关门成功!"}):"关门失败"===t.data&&e.$message({type:"success",message:"关门失败!"})},e.ws.onerror=function(t){e.$message({type:"error",message:"串口连接失败！"})},e.ws.onclose=function(t){console.log(t),e.get_new()}}else console.log("您的浏览器不支持WebSocket")},get_new:function(){this.webSocket()},get_one:function(){var e=this;e.timer=setInterval(function(){e.ws.send("自动选择串口")},5e3)},get_open:function(){this.ws.send("开门")},get_close:function(){this.ws.send("关门")}}},z={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"WebSerialApi"},[a("el-button",{on:{click:e.get_one}},[e._v("自动选择串口")]),e._v(" "),a("el-button",{on:{click:e.get_open}},[e._v("open")]),e._v(" "),a("el-button",{on:{click:e.get_close}},[e._v("close")]),e._v(" "),a("el-button",{on:{click:e.get_new}},[e._v("重新连接")])],1)},staticRenderFns:[]};var H=a("VU/8")(L,z,!1,function(e){a("vKYM")},"data-v-597ba696",null).exports,P={name:"GroupPreAssemblyInputSystem",components:{},watch:{errorText:{handler:function(e,t){var a=this;!0===e&&setTimeout(function(){a.errorText=!1},6e4)}}},mounted:function(){clearInterval(this.timer),clearInterval(this.timer2),this.get_all_process(),this.get_loacl_storage()},methods:{oneSubmit:function(){this.$refs.workOrder.focus()},get_loacl_storage:function(){null!==localStorage.getItem("workerData")&&(console.log("workerData",JSON.parse(localStorage.getItem("workerData"))),this.form=JSON.parse(localStorage.getItem("workerData")),this.get_glue_aging(),this.get_add_data())},get_add_data:function(){var e=this,t="JS"+e.form.name;e.$axios({url:"/display/entry/prepare-assemble-product-output-number",method:"get",params:{workOrder:e.form.workOrder,worker:t,process:e.form.process}}).then(function(t){console.log("累计总数：",t);var a=t.data;null!==a&&(e.form.addUpNumber=a)}).catch(function(t){console.log(t),e.$message({type:"error",message:"获取累计总数失败！"})}),e.$axios({url:"/display/entry/prepare-assemble-product-bad-output-number",method:"get",params:{workOrder:e.form.workOrder,worker:t,process:e.form.process}}).then(function(t){console.log("累计不良：",t);var a=t.data;null!==a&&(e.form.addDownNumber=a)}).catch(function(t){console.log(t),e.$message({type:"error",message:"获取累计不良数失败！"})})},clear_form:function(){this.form={name:"",workOrder:"",pn:"",bom:"",station:"",process:"",materialCode:"",materialLot:"",glueId:"",startTime:"",endTime:"",sn:"",totalCount:"0",failCount:"0",tco:"1",addUpNumber:"0",addDownNumber:"0"}},get_workOrder:function(){if(console.log(this.form.workOrder),""!==this.form.name)if(""===this.form.workOrder)this.$message({type:"error",message:"未输入工单号!"});else{var e=this;e.$axios({url:"/display/entry/pn-and-bom-by-worker-order",method:"get",params:{workOrder:e.form.workOrder}}).then(function(t){console.log(t);var a=t.data;null!==a&&(e.form.pn=a.Pn,e.form.bom=a.Bom,e.$refs.station.focus())}).catch(function(){this.$message({type:"error",message:"获取数据失败！"})})}else this.$message({type:"error",message:"未输入员工工号！"})},get_k3:function(){var e=this;e.$axios({url:"/display/entry/k3-material-by-work-order",method:"get",params:{workOrder:e.form.workOrder}}).then(function(t){console.log(t);var a=t.data;null!==a&&(e.k3_data=a)}).catch(function(){this.$message({type:"error",message:"获取数据失败！"})})},get_process:function(){""===this.form.station?(this.process_select=!0,this.$message({type:"error",message:"请先输入台位编号！"})):this.process_select=!1},get_all_process:function(){var e=this;e.options=[],e.$axios({url:"/display/entry/all-process",method:"get"}).then(function(t){console.log(t);var a=t.data;if(null!==a)for(var o=0;o<a.length;o++)console.log(a[o]),e.options.push({value:a[o],label:a[o]})}).catch(function(){this.$message({type:"error",message:"获取数据失败！"})})},post_process:function(){this.form.materialCode="",this.form.materialLot="",this.tcavalue=!0,this.keyMaterialValidateForm.domains=[],this.keyMaterialLogValidateForm.data=[]},put_material_code:function(){var e=this;""===e.form.materialCode&&(e.keyMaterialValidateForm.domains=[]),""!==e.form.workOrder&&""!==e.form.process?""===this.form.materialCode?(e.keyMaterial=[],e.$axios({url:"/display/entry/k3-material-of-process-by-process",method:"get",params:{process:e.form.process}}).then(function(t){console.log(t);var a=t.data;if(null!==a){var o=w()(a),s=y()(a);console.log(o),console.log(s);for(var r=function(t){1===o[t]&&"Id"!==s[t]&&(console.log(s[t]),e.keyMaterial.push(s[t]),e.$axios({url:"/display/entry/key-material-prefix-code-by-material",method:"get",params:{materialNickname:s[t]}}).then(function(a){console.log(a);var o=a.data;null!==o&&(console.log(o[0].Material),e.keyMaterialValidateForm.domains.push({key:o[0].Material,name:s[t],value:""}))}))},l=0;l<o.length;l++)r(l);e.addmaterialdialogVisible=!0}}).catch(function(){this.$message({type:"error",message:"获取数据失败！"})})):e.addmaterialdialogVisible=!0:""===e.form.workOrder?e.$message({type:"error",message:"请先完成工单匹配！"}):""!==e.form.workOrder&&""===e.form.process&&e.$message({type:"error",message:"请先选择当前工序！"})},open_k3_check:function(){console.log(this.tcavalue),!1===this.tcavalue?(this.tcavalue=!0,this.tcodialogVisible=!0,this.$message({type:"warning",message:"请先通过密码校验！"})):!0===this.tcavalue&&this.$message({type:"success",message:"已开起K3校验！"})},get_k3_password:function(){"85200"===this.k3Password?(this.tcavalue=!1,this.tcodialogVisible=!1,this.$message({type:"success",message:"校验成功，已关闭k3校验！"})):this.$message({type:"error",message:"校验失败,请输入正确的密码！"})},get_Verification:function(){if(console.log(this.tcavalue),!0===this.tcavalue){if(this.form.tco="0",""!==this.form.workOrder){for(var e=this,t=[],a=0;a<e.keyMaterialValidateForm.domains.length;a++)t=t.concat(e.keyMaterialValidateForm.domains[a].value.split(/[(\r\n)\r\n]+/));new _.a(t).size!==t.length?e.$message({type:"error",message:"存在重复的物料代码,请重新验证！"}):(e.post_glue_id(),e.errkey=[],e.$axios({url:"/display/entry/k3-material-by-work-order",method:"get",params:{workOrder:e.form.workOrder}}).then(function(t){console.log(t);var a=t.data;if(null!==a&&(e.k3_data=a,console.log(e.keyMaterialValidateForm.domains.length),e.keyMaterialValidateForm.domains.length>0))for(var o=function(t){var a=[].concat(h()(new _.a(e.keyMaterialValidateForm.domains[t].value.split(/[(\r\n)\r\n]+/))));console.log(a);for(var o=0;o<a.length;o++)""===a[o]&&(a.splice(o,1),o--);e.$axios({url:"/display/entry/key-material-prefix-code-by-material",method:"get",params:{materialNickname:e.keyMaterialValidateForm.domains[t].name}}).then(function(t){console.log(t);var o=t.data[0];if(null!==o){console.log(o.PrefixCode);for(var s=o.PrefixCode.split(","),r=0;r<a.length;r++)if(a[r].length<8)e.errkey.push(a[r]);else{for(var l=!0,i=0;i<s.length;i++)a[r].substring(0,8)===s[i]&&(l=!1);if(!0===l)e.errkey.push(a[r]);else{var n=0;console.log(e.k3_data[l]),console.log(a[r]);for(var c=0;c<e.k3_data.length;c++)e.k3_data[c]===a[r]&&(n=1);0===n&&e.errkey.push(a[r])}}if(e.errkey.length>0){console.log(e.errkey),e.materialsThatHaveNotPassedValidationVisible=!0,e.text="";for(var m=0;m<e.errkey.length;m++)e.text=0===m?e.text+e.errkey[m]:e.text+"和"+e.errkey[m]}else{e.$message({type:"success",message:"验证通过！"}),e.post_glue_id();for(var d="",u=0;u<e.keyMaterialValidateForm.domains.length;u++){var f=[].concat(h()(new _.a(e.keyMaterialValidateForm.domains[u].value.split(/[(\r\n)\r\n]+/))));console.log(f);for(var p=0;p<f.length;p++)""!==f[p]&&(d=d+e.keyMaterialValidateForm.domains[u].key+":"+f[p]+";")}e.form.materialCode=d,console.log(e.form.materialCode),console.log(e.keyMaterialValidateForm.domains),e.addmaterialdialogVisible=!1}}})},s=0;s<e.keyMaterialValidateForm.domains.length;s++)o(s)}).catch(function(){this.$message({type:"error",message:"获取数据失败！"})})),console.log(e.keyMaterialValidateForm)}}else{this.form.tco="1";for(var o="",s=[],r=0;r<this.keyMaterialValidateForm.domains.length;r++)s=s.concat(this.keyMaterialValidateForm.domains[r].value.split(/[(\r\n)\r\n]+/));if(new _.a(s).size!==s.length)this.$message({type:"error",message:"存在重复的物料代码,请重新验证！"});else{this.post_glue_id(),this.$message({type:"success",message:"验证通过！"});for(var l=0;l<this.keyMaterialValidateForm.domains.length;l++){var i=this.keyMaterialValidateForm.domains[l].value.split(/[(\r\n)\r\n]+/);console.log(i);for(var n=0;n<i.length;n++)""!==i[n]&&(o=o+this.keyMaterialValidateForm.domains[l].key+":"+i[n]+";");console.log(o)}this.form.materialCode=o,console.log(this.form.materialCode),console.log(this.keyMaterialValidateForm.domains),this.addmaterialdialogVisible=!1}}},post_glue_id:function(){this.form.materialLot="",this.keyMaterialLogValidateForm.data=[]},put_material_log:function(){if(""!==this.form.materialCode){if(0===this.keyMaterialLogValidateForm.data.length)for(var e=0;e<this.keyMaterialValidateForm.domains.length;e++){var t=this.keyMaterialValidateForm.domains[e].value.split(/[(\r\n)\r\n]+/);console.log(t);for(var a=0;a<t.length;a++)""!==t[a]&&(this.keyMaterialLogValidateForm.data.push({key:t[a],value:""}),console.log(this.keyMaterialLogValidateForm.data))}this.addMaterialLotDialogVisible=!0}else this.$message({type:"error",message:"请先添加物料代码！"})},get_add_material_log:function(){console.log(this.keyMaterialLogValidateForm);var e=JSON.parse(p()(this.keyMaterialLogValidateForm)),t=JSON.parse(p()(this.keyMaterialLogValidateForm));console.log(e);for(var a="",o=[],s=!1,r=0;r<e.data.length;r++)o=o.concat(e.data[r].value.split(/[(\r\n)\r\n]+/));if(console.log(o),new _.a(o).size!==o.length?this.$message({type:"error",message:"存在重复的物料代码,请重新验证！"}):(this.post_glue_id(),this.$message({type:"success",message:"验证通过！"}),s=!0),console.log(t),!0===s){for(var l=0;l<t.data.length;l++){var i=t.data[l].value.split(/[(\r\n)\r\n]+/);console.log(i);for(var n=0;n<i.length;n++)""!==i[n]&&(a=a+t.data[l].key+":"+i[n]+";")}this.form.materialLot=a,console.log(this.form.materialLot),this.addMaterialLotDialogVisible=!1}},get_glue_aging:function(){var e=this;""!==e.form.materialLot?""!==e.form.glueId&&(clearInterval(e.timer),e.effectivePrescription=!1,e.$axios({url:"/display/glue/glue-info-by-glue-id",method:"get",params:{glueId:e.form.glueId}}).then(function(t){console.log(t);var a=t.data;if(null!==a){console.log(a.CreatedTime),console.log(new Date(a.CreatedTime));var o=e.moment(new Date).format("YYYY-MM-DD HH:mm:ss");console.log(o),new Date-new Date(a.CreatedTime)>=48e5||1===a.RecycleFlag?(e.$alert("当前胶水已超出时效或已回收!","警告",{confirmButtonText:"确定"}),console.log("超出时效"),console.log((new Date-new Date(a.CreatedTime))/1e3)):(console.log("未超出时效"),e.time=((new Date(a.CreatedTime)-new Date+48e5)/1e3).toFixed(0),e.effectivePrescription=!0,e.timer=setInterval(function(){new Date-new Date(a.CreatedTime)>=48e5||1===a.RecycleFlag?(console.log("超出时效"),e.effectivePrescription=!1,clearInterval(e.timer)):(console.log("未超出时效"),e.effectivePrescription=!0,e.time=((new Date(a.CreatedTime)-new Date+48e5)/1e3).toFixed(0))},1e3))}}).catch(function(){e.$message({type:"error",message:"无此胶水ID！"})})):e.$message({type:"error",message:"未添加物料批次号，无法获取胶水时效！"})},confirm_add:function(){if(""!==this.form.startTime){var e=this.textareaSn.split(/[(\r\n)\r\n]+/);if(new _.a(e).size!==e.length)this.$message({type:"error",message:"有重复的sn，请重新添加sn！"});else{var t="",a=0;if(console.log(e),e.length>0)for(var o=0;o<e.length;o++)""!==e[o]&&(0!==o?(t=t+";"+e[o],a+=1):(t+=e[o],a+=1));console.log(t),console.log(a),this.form.totalCount=a,this.form.sn=t,this.total_ount=!1}}else this.$message({type:"error",message:"请先开始工作,再进行添加SN！"})},post_entry:function(e){var t=this;this.$refs[e].validate(function(e){if(e)if(""!==t.form.pn||""!==t.form.bom)if(t.form.totalCount>=t.form.failCount){var a=t,o=new FormData,s="JS"+a.form.name;o.append("worker_id",s),o.append("work_order_num",a.form.workOrder),o.append("pn",a.form.pn),o.append("bom",a.form.bom),o.append("station_id",a.form.station),o.append("process",a.form.process),o.append("item_code",a.form.materialCode),o.append("material_num",a.form.materialLot),o.append("glue_id",a.form.glueId),o.append("start_time",a.moment(new Date).format("YYYY-MM-DD HH:mm:ss")),o.append("end_time",a.moment(new Date).format("YYYY-MM-DD HH:mm:ss")),o.append("sn",a.form.sn),o.append("total_count",a.form.totalCount),o.append("fail_count",a.form.failCount),o.append("tco",a.form.tco),a.$axios({url:"/display/entry/prepare-assemble-product-record",method:"post",data:o}).then(function(e){200===e.status&&a.$message({type:"success",message:"录入成功!"});var t={name:a.form.name,workOrder:a.form.workOrder,pn:a.form.pn,bom:a.form.bom,station:a.form.station,process:a.form.process,materialCode:a.form.materialCode,materialLot:a.form.materialLot,glueId:a.form.glueId,startTime:"",endTime:"",sn:a.form.sn,totalCount:a.form.totalCount,failCount:a.form.failCount,tco:a.form.tco,addUpNumber:a.form.addUpNumber,addDownNumber:a.form.addDownNumber};localStorage.setItem("workerData",p()(t)),setTimeout(function(){location.reload()},2e3)}).catch(function(){a.$message({type:"error",message:"录入失败！"})})}else t.$message({type:"error",message:"不良总数大于生产总数,无法录入！"});else t.$message({type:"error",message:"未进行工单匹配，无法录入！"});else t.$message({type:"error",message:"数据有误，无法录入！"})})}},beforeDestroy:function(){clearInterval(this.timer),clearInterval(this.timer2)},data:function(){return{form:{name:"",workOrder:"",pn:"",bom:"",station:"",process:"",materialCode:"",materialLot:"",glueId:"",startTime:"",endTime:"",sn:"",totalCount:"0",failCount:"0",tco:"1",addUpNumber:"0",addDownNumber:"0"},rules:{name:[{required:!0,message:"请输入工号(数字)",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"},{validator:function(e,t,a){!1===/^[0-9]{2,50}$/.test(t)?a(new Error("请输入工号(数字)")):a()},trigger:"blur"}]},keyMaterialValidateForm:{domains:[]},keyMaterialLogValidateForm:{data:[]},tagType:"info",errorText:!1,serialText:"",time:48e5,text:"",k3Password:"",textareaSn:"",k3_data:[],errkey:[],options:[],keyMaterial:[],idjudge:!1,total_ount:!1,addSn:!0,tcavalue:!0,visible:!1,process_select:!0,effectivePrescription:!1,tcodialogVisible:!1,addmaterialdialogVisible:!1,addMaterialLotDialogVisible:!1,materialsThatHaveNotPassedValidationVisible:!1}}},Y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"GroupPreAssemblyInputSystem"},[a("h3",[e._v("\n    优博创数字化工厂——预组录入系统\n    ")]),e._v(" "),a("div",{staticStyle:{border:"1px solid black",margin:"0 auto",width:"90%"}},[a("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"150px",size:"mini"}},[a("el-form-item",{attrs:{label:"员工工号",prop:"name"}},[a("el-input",{staticStyle:{width:"100%"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.oneSubmit(t)}},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[a("template",{slot:"prepend"},[e._v("JS")])],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"工单号"}},[a("el-input",{ref:"workOrder",staticStyle:{width:"69%"},on:{blur:e.get_workOrder},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.get_workOrder(t)}},model:{value:e.form.workOrder,callback:function(t){e.$set(e.form,"workOrder",t)},expression:"form.workOrder"}}),e._v(" "),a("el-button",{staticStyle:{"background-color":"#409eff",color:"#fff",width:"30%"},on:{click:e.get_workOrder}},[e._v("工单匹配")])],1),e._v(" "),a("el-form-item",{attrs:{label:"产品PN"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{disabled:!0},model:{value:e.form.pn,callback:function(t){e.$set(e.form,"pn",t)},expression:"form.pn"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"BOM"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{disabled:!0},model:{value:e.form.bom,callback:function(t){e.$set(e.form,"bom",t)},expression:"form.bom"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"台位编号"}},[a("el-input",{ref:"station",staticStyle:{width:"100%"},model:{value:e.form.station,callback:function(t){e.$set(e.form,"station",t)},expression:"form.station"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"当前工序"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择当前工序"},on:{change:e.post_process,focus:e.get_process},model:{value:e.form.process,callback:function(t){e.$set(e.form,"process",t)},expression:"form.process"}},e._l(e.options,function(t){return a("el-option",{key:t.value,attrs:{disabled:e.process_select,label:t.label,value:t.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"物料代码"}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.form.materialCode))]),e._v(" "),a("el-input",{staticStyle:{width:"69%"},attrs:{disabled:!0},on:{change:e.post_glue_id},model:{value:e.form.materialCode,callback:function(t){e.$set(e.form,"materialCode",t)},expression:"form.materialCode"}})],1),e._v(" "),a("el-button",{staticStyle:{"background-color":"#409eff",color:"#fff",width:"30%"},on:{click:e.put_material_code}},[e._v("添加物料代码")])],1),e._v(" "),a("el-form-item",{attrs:{label:"物料批次号"}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.form.materialLot))]),e._v(" "),a("el-input",{staticStyle:{width:"69%"},attrs:{disabled:!0},model:{value:e.form.materialLot,callback:function(t){e.$set(e.form,"materialLot",t)},expression:"form.materialLot"}})],1),e._v(" "),a("el-button",{staticStyle:{"background-color":"#409eff",color:"#fff",width:"30%"},on:{click:e.put_material_log}},[e._v("添加物料批次")])],1),e._v(" "),a("el-form-item",{attrs:{label:"胶水ID"}},[a("el-input",{staticStyle:{width:"69%"},attrs:{disabled:e.idjudge},on:{change:e.get_glue_aging},model:{value:e.form.glueId,callback:function(t){e.$set(e.form,"glueId",t)},expression:"form.glueId"}}),e._v(" "),e.effectivePrescription?a("el-button",{staticStyle:{"background-color":"#67C23A",color:"#fff",width:"30%"}},[e._v("时效："+e._s(e.time)+" 秒")]):a("el-button",{staticStyle:{"background-color":"red",color:"#fff",width:"30%"}},[e._v("时效：0 秒")])],1),e._v(" "),a("el-form-item",{attrs:{label:"本次数量"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{disabled:e.total_ount},model:{value:e.form.totalCount,callback:function(t){e.$set(e.form,"totalCount",t)},expression:"form.totalCount"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"不良数量"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{min:0,max:e.form.totalCount},model:{value:e.form.failCount,callback:function(t){e.$set(e.form,"failCount",e._n(t))},expression:"form.failCount"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"已录入数"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{min:0,disabled:!0},model:{value:e.form.addUpNumber,callback:function(t){e.$set(e.form,"addUpNumber",e._n(t))},expression:"form.addUpNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"已录入不良"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{min:0,disabled:!0},model:{value:e.form.addDownNumber,callback:function(t){e.$set(e.form,"addDownNumber",e._n(t))},expression:"form.addDownNumber"}})],1),e._v(" "),a("el-form-item",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:10}},[a("el-button",{attrs:{type:"primary"},on:{click:e.clear_form}},[e._v("重置")])],1),e._v(" "),a("el-col",{attrs:{span:10}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.post_entry("form")}}},[e._v("录入")])],1)],1)],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"添加关键物料",visible:e.addmaterialdialogVisible,width:"80%"},on:{"update:visible":function(t){e.addmaterialdialogVisible=t}}},[a("el-dialog",{attrs:{title:"tco验证",visible:e.tcodialogVisible,width:"80%","append-to-body":""},on:{"update:visible":function(t){e.tcodialogVisible=t}}},[a("el-form",{attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"请输入密码："}},[a("el-input",{staticStyle:{width:"68%"},attrs:{"show-password":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.get_k3_password(t)}},model:{value:e.k3Password,callback:function(t){e.k3Password=t},expression:"k3Password"}}),e._v(" "),a("el-button",{staticStyle:{width:"30%"},on:{click:e.get_k3_password}},[e._v("确认")])],1)],1)],1),e._v(" "),a("el-form",{staticClass:"demo-dynamic",attrs:{model:e.keyMaterialValidateForm,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"是否开启K3检验(TCO)"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"开","inactive-text":"关"},on:{change:e.open_k3_check},model:{value:e.tcavalue,callback:function(t){e.tcavalue=t},expression:"tcavalue"}})],1),e._v(" "),e._l(e.keyMaterialValidateForm.domains,function(t,o){return a("el-form-item",{key:t.key,attrs:{label:e.keyMaterialValidateForm.domains[o].key,prop:"domains."+o+".value",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"domain.value"}})],1)})],2),e._v(" "),a("el-button",{on:{click:e.get_Verification}},[e._v("验证")]),e._v(" "),a("el-dialog",{attrs:{width:"30%",title:"未验证通过的物料",visible:e.materialsThatHaveNotPassedValidationVisible,"append-to-body":""},on:{"update:visible":function(t){e.materialsThatHaveNotPassedValidationVisible=t}}},[a("p",[e._v(e._s(e.text))])])],1),e._v(" "),a("el-dialog",{attrs:{title:"添加物料批次",visible:e.addMaterialLotDialogVisible,width:"80%"},on:{"update:visible":function(t){e.addMaterialLotDialogVisible=t}}},[a("el-form",{staticClass:"demo-dynamic",attrs:{model:e.keyMaterialLogValidateForm,"label-width":"130px"}},e._l(e.keyMaterialLogValidateForm.data,function(t,o){return a("el-form-item",{key:t.key,attrs:{label:e.keyMaterialLogValidateForm.data[o].key,prop:"data."+o+".value",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"data.value"}})],1)}),1),e._v(" "),a("el-button",{on:{click:e.get_add_material_log}},[e._v("确认添加")])],1)],1)},staticRenderFns:[]};var E=a("VU/8")(P,Y,!1,function(e){a("p/Am")},"data-v-06cd740d",null).exports;r.default.use(m.a);var A=new m.a({routes:[{path:"/",name:"HelloWorld",component:u},{path:"/material",component:S,children:[{path:"material_glue",component:S}]},{path:"/glue",component:j,children:[{path:"compound_glue",component:j}]},{path:"/api",component:H,children:[{path:"web_serial_api",component:H}]},{path:"/test",component:I,children:[{path:"pregroup_test",component:I}]},{path:"/equipment",component:R,children:[{path:"osa_equipment_information_entry",component:R}]},{path:"/group_pre_assembly",component:E,children:[{path:"group_pre_assembly_input_system",component:E}]}]}),q=a("zL8q"),U=a.n(q),G=(a("tvR6"),a("mtWM")),W=a.n(G),J=a("PJh5"),B=a.n(J);r.default.use(U.a),r.default.config.productionTip=!1,r.default.prototype.$axios=W.a,r.default.prototype.moment=B.a,W.a.interceptors.request.use(function(e){e.headers["X-Requested-With"]="XMLHttpRequest";var t=/.*csrftoken=([^;.]*).*$/;return e.headers["X-CSRFToken"]=null===document.cookie.match(t)?null:document.cookie.match(t)[1],e.headers.authorization=localStorage.getItem("Token"),e},function(e){return s.a.reject(e)}),new r.default({el:"#app",router:A,components:{App:c},template:"<App/>"})},VVhN:function(e,t){},Zaqt:function(e,t){},c4wz:function(e,t){},dbEy:function(e,t){},iYGR:function(e,t){},"p/Am":function(e,t){},tvR6:function(e,t){},uUi1:function(e,t){},uslO:function(e,t,a){var o={"./af":"3CJN","./af.js":"3CJN","./ar":"3MVc","./ar-dz":"tkWw","./ar-dz.js":"tkWw","./ar-kw":"j8cJ","./ar-kw.js":"j8cJ","./ar-ly":"wPpW","./ar-ly.js":"wPpW","./ar-ma":"dURR","./ar-ma.js":"dURR","./ar-sa":"7OnE","./ar-sa.js":"7OnE","./ar-tn":"BEem","./ar-tn.js":"BEem","./ar.js":"3MVc","./az":"eHwN","./az.js":"eHwN","./be":"3hfc","./be.js":"3hfc","./bg":"lOED","./bg.js":"lOED","./bm":"hng5","./bm.js":"hng5","./bn":"aM0x","./bn-bd":"1C9R","./bn-bd.js":"1C9R","./bn.js":"aM0x","./bo":"w2Hs","./bo.js":"w2Hs","./br":"OSsP","./br.js":"OSsP","./bs":"aqvp","./bs.js":"aqvp","./ca":"wIgY","./ca.js":"wIgY","./cs":"ssxj","./cs.js":"ssxj","./cv":"N3vo","./cv.js":"N3vo","./cy":"ZFGz","./cy.js":"ZFGz","./da":"YBA/","./da.js":"YBA/","./de":"DOkx","./de-at":"8v14","./de-at.js":"8v14","./de-ch":"Frex","./de-ch.js":"Frex","./de.js":"DOkx","./dv":"rIuo","./dv.js":"rIuo","./el":"CFqe","./el.js":"CFqe","./en-au":"Sjoy","./en-au.js":"Sjoy","./en-ca":"Tqun","./en-ca.js":"Tqun","./en-gb":"hPuz","./en-gb.js":"hPuz","./en-ie":"ALEw","./en-ie.js":"ALEw","./en-il":"QZk1","./en-il.js":"QZk1","./en-in":"yJfC","./en-in.js":"yJfC","./en-nz":"dyB6","./en-nz.js":"dyB6","./en-sg":"NYST","./en-sg.js":"NYST","./eo":"Nd3h","./eo.js":"Nd3h","./es":"LT9G","./es-do":"7MHZ","./es-do.js":"7MHZ","./es-mx":"USNP","./es-mx.js":"USNP","./es-us":"INcR","./es-us.js":"INcR","./es.js":"LT9G","./et":"XlWM","./et.js":"XlWM","./eu":"sqLM","./eu.js":"sqLM","./fa":"2pmY","./fa.js":"2pmY","./fi":"nS2h","./fi.js":"nS2h","./fil":"rMbQ","./fil.js":"rMbQ","./fo":"OVPi","./fo.js":"OVPi","./fr":"tzHd","./fr-ca":"bXQP","./fr-ca.js":"bXQP","./fr-ch":"VK9h","./fr-ch.js":"VK9h","./fr.js":"tzHd","./fy":"g7KF","./fy.js":"g7KF","./ga":"U5Iz","./ga.js":"U5Iz","./gd":"nLOz","./gd.js":"nLOz","./gl":"FuaP","./gl.js":"FuaP","./gom-deva":"VGQH","./gom-deva.js":"VGQH","./gom-latn":"+27R","./gom-latn.js":"+27R","./gu":"rtsW","./gu.js":"rtsW","./he":"Nzt2","./he.js":"Nzt2","./hi":"ETHv","./hi.js":"ETHv","./hr":"V4qH","./hr.js":"V4qH","./hu":"xne+","./hu.js":"xne+","./hy-am":"GrS7","./hy-am.js":"GrS7","./id":"yRTJ","./id.js":"yRTJ","./is":"upln","./is.js":"upln","./it":"FKXc","./it-ch":"/E8D","./it-ch.js":"/E8D","./it.js":"FKXc","./ja":"ORgI","./ja.js":"ORgI","./jv":"JwiF","./jv.js":"JwiF","./ka":"RnJI","./ka.js":"RnJI","./kk":"j+vx","./kk.js":"j+vx","./km":"5j66","./km.js":"5j66","./kn":"gEQe","./kn.js":"gEQe","./ko":"eBB/","./ko.js":"eBB/","./ku":"kI9l","./ku.js":"kI9l","./ky":"6cf8","./ky.js":"6cf8","./lb":"z3hR","./lb.js":"z3hR","./lo":"nE8X","./lo.js":"nE8X","./lt":"/6P1","./lt.js":"/6P1","./lv":"jxEH","./lv.js":"jxEH","./me":"svD2","./me.js":"svD2","./mi":"gEU3","./mi.js":"gEU3","./mk":"Ab7C","./mk.js":"Ab7C","./ml":"oo1B","./ml.js":"oo1B","./mn":"CqHt","./mn.js":"CqHt","./mr":"5vPg","./mr.js":"5vPg","./ms":"ooba","./ms-my":"G++c","./ms-my.js":"G++c","./ms.js":"ooba","./mt":"oCzW","./mt.js":"oCzW","./my":"F+2e","./my.js":"F+2e","./nb":"FlzV","./nb.js":"FlzV","./ne":"/mhn","./ne.js":"/mhn","./nl":"3K28","./nl-be":"Bp2f","./nl-be.js":"Bp2f","./nl.js":"3K28","./nn":"C7av","./nn.js":"C7av","./oc-lnc":"KOFO","./oc-lnc.js":"KOFO","./pa-in":"pfs9","./pa-in.js":"pfs9","./pl":"7LV+","./pl.js":"7LV+","./pt":"ZoSI","./pt-br":"AoDM","./pt-br.js":"AoDM","./pt.js":"ZoSI","./ro":"wT5f","./ro.js":"wT5f","./ru":"ulq9","./ru.js":"ulq9","./sd":"fW1y","./sd.js":"fW1y","./se":"5Omq","./se.js":"5Omq","./si":"Lgqo","./si.js":"Lgqo","./sk":"OUMt","./sk.js":"OUMt","./sl":"2s1U","./sl.js":"2s1U","./sq":"V0td","./sq.js":"V0td","./sr":"f4W3","./sr-cyrl":"c1x4","./sr-cyrl.js":"c1x4","./sr.js":"f4W3","./ss":"7Q8x","./ss.js":"7Q8x","./sv":"Fpqq","./sv.js":"Fpqq","./sw":"DSXN","./sw.js":"DSXN","./ta":"+7/x","./ta.js":"+7/x","./te":"Nlnz","./te.js":"Nlnz","./tet":"gUgh","./tet.js":"gUgh","./tg":"5SNd","./tg.js":"5SNd","./th":"XzD+","./th.js":"XzD+","./tk":"+WRH","./tk.js":"+WRH","./tl-ph":"3LKG","./tl-ph.js":"3LKG","./tlh":"m7yE","./tlh.js":"m7yE","./tr":"k+5o","./tr.js":"k+5o","./tzl":"iNtv","./tzl.js":"iNtv","./tzm":"FRPF","./tzm-latn":"krPU","./tzm-latn.js":"krPU","./tzm.js":"FRPF","./ug-cn":"To0v","./ug-cn.js":"To0v","./uk":"ntHu","./uk.js":"ntHu","./ur":"uSe8","./ur.js":"uSe8","./uz":"XU1s","./uz-latn":"/bsm","./uz-latn.js":"/bsm","./uz.js":"XU1s","./vi":"0X8Q","./vi.js":"0X8Q","./x-pseudo":"e/KL","./x-pseudo.js":"e/KL","./yo":"YXlc","./yo.js":"YXlc","./zh-cn":"Vz2w","./zh-cn.js":"Vz2w","./zh-hk":"ZUyn","./zh-hk.js":"ZUyn","./zh-mo":"+WA1","./zh-mo.js":"+WA1","./zh-tw":"BbgG","./zh-tw.js":"BbgG"};function s(e){return a(r(e))}function r(e){var t=o[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}s.keys=function(){return Object.keys(o)},s.resolve=r,e.exports=s,s.id="uslO"},vKYM:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.5f0aaed341fb7b7b3d99.js.map